!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("rxjs/Subject"),require("rxjs/Subscription")):"function"==typeof define&&define.amd?define(["exports","@angular/core","rxjs/Subject","rxjs/Subscription"],e):e(t["ngx-emoji"]={},t.ng.core,t.Rx,t.Rx)}(this,function(t,e,n,i){"use strict";var o=function(){function t(){}return t.prototype.fromHtml=function(t){return t.replace("<br>","\n")},t.prototype.toHtml=function(t){return t.replace("\n","<br>")},t.prototype.filterHtml=function(t){var e=document.createElement("div");return e.innerHTML=t,t=e.textContent||e.innerText||""},t}(),r=function(){function t(t,n){this.elRef=t,this.contenteditable=!1,this.enterOn={shift:!1,ctrl:!1},this.htmlConverter=new o,this.emojiServiceSubscription=new i.Subscription,this.lastSelectionRange={start:0,stop:0},this.onText=new e.EventEmitter,this.onEnter=new e.EventEmitter,this.onEntities=new e.EventEmitter;var r=this;n.setActiveComponent(this),this.emojiService=n;var s=this.emojiService.onEmojiPicked.subscribe(function(t){r.insertEmoji(t)});this.emojiServiceSubscription.add(s)}return t.prototype.ngOnDestroy=function(){this.emojiServiceSubscription.unsubscribe()},t.prototype.addEmojiService=function(t){t.setActiveComponent(this);var e=this,n=t.onEmojiPicked.subscribe(function(t){e.insertEmoji(t)});this.emojiServiceSubscription.add(n)},Object.defineProperty(t.prototype,"inputPicker",{set:function(t){this.emojiServiceSubscription.unsubscribe(),this.emojiServiceSubscription=new i.Subscription,this.emojiService=new s,this.emojiService.setActiveComponent(this),t.setEmojiService(this.emojiService);var e=this,n=this.emojiService.onEmojiPicked.subscribe(function(t){e.insertEmoji(t)});this.emojiServiceSubscription.add(n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"attrContenteditable",{set:function(t){this.setContentEditable(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputContenteditable",{set:function(t){this.setContentEditable(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputEnterOn",{set:function(t){this.enterOn=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputText",{set:function(t){this.setText(t)},enumerable:!0,configurable:!0}),t.prototype.onKeydownEnter=function(t){this.isContentEditable()&&(t.preventDefault(),this.enterKeyIsEnter()?this.emitEnter():this.insertNewLine())},t.prototype.onKeydownControlEnter=function(t){this.isContentEditable()&&(t.preventDefault(),this.enterKeyIsCtrlEnter()&&this.emitEnter())},t.prototype.onKeydownShiftEnter=function(t){this.isContentEditable()&&(t.preventDefault(),this.enterKeyIsShiftEnter()&&this.emitEnter())},t.prototype.onFocus=function(){this.emojiService.setActiveComponent(this)},t.prototype.onFocusout=function(){this.lastSelectionRange=this.getSelectionRange()},t.prototype.setContentEditable=function(t){this.contenteditable=t,this.elRef.nativeElement.setAttribute("contenteditable",t)},t.prototype.isContentEditable=function(){return this.contenteditable},t.prototype.enterKeyIsEnter=function(){return!this.enterKeyIsShiftEnter()&&!this.enterKeyIsCtrlEnter()},t.prototype.enterKeyIsCtrlEnter=function(){return!!this.enterOn.ctrl},t.prototype.enterKeyIsShiftEnter=function(){return!!this.enterOn.shift},t.prototype.setText=function(t){this.elRef.nativeElement.innerHTML=this.htmlConverter.filterHtml(t)},t.prototype.getText=function(){var t=this.elRef.nativeElement.innerHTML;return"\n\n"==t.substr(t.length-2)&&(t=t.substr(0,t.length-1)),t},t.prototype.getNativeElement=function(){return this.elRef.nativeElement},t.prototype.emitEnter=function(){this.onText.emit(this.getText()),this.onEnter.emit(),this.elRef.nativeElement.innerHTML=""},t.prototype.insertNewLine=function(){this.insertText("\n")},t.prototype.insertEmoji=function(t){this.isContentEditable()&&this.emojiService.isActiveComponent(this)&&this.insertText(" "+t+" ")},t.prototype.insertText=function(t){var e,n=this.elRef.nativeElement.innerHTML;e=document.activeElement===this.elRef.nativeElement?this.getSelectionRange():this.lastSelectionRange,this.elRef.nativeElement.innerHTML=n.substr(0,e.start)+t+n.substr(e.stop),e.stop==n.length&&"\n"==t&&(this.elRef.nativeElement.innerHTML=this.elRef.nativeElement.innerHTML+"\n"),this.setCaretPosition(e.start+t.length)},t.prototype.getSelectionRange=function(){var t=window.getSelection(),e=0,n=0;return"Caret"==t.type&&(e=t.extentOffset,n=t.extentOffset),"Range"==t.type&&(e=t.extentOffset)>(n=t.anchorOffset)&&(e=t.anchorOffset,n=t.extentOffset),{start:e,stop:n}},t.prototype.setCaretPosition=function(t){window.getSelection().collapse(this.elRef.nativeElement.firstChild,t)},t}();r.decorators=[{type:e.Component,args:[{selector:"ngx-emoji",template:"",styles:["ngx-emoji,\nngx-emoji-picker {\n  display: block;\n}\nngx-emoji {\n  white-space: pre-wrap;\n}\n"]}]}],r.ctorParameters=function(){return[{type:e.ElementRef},{type:s}]},r.propDecorators={inputPicker:[{type:e.Input,args:["picker"]}],attrContenteditable:[{type:e.Input,args:["attr.contenteditable"]}],inputContenteditable:[{type:e.Input,args:["contenteditable"]}],inputEnterOn:[{type:e.Input,args:["enterOn"]}],inputText:[{type:e.Input,args:["text"]}],onText:[{type:e.Output,args:["text"]}],onEnter:[{type:e.Output,args:["enter"]}],onEntities:[{type:e.Output,args:["entities"]}],onKeydownEnter:[{type:e.HostListener,args:["keydown.enter",["$event"]]}],onKeydownControlEnter:[{type:e.HostListener,args:["keydown.control.enter",["$event"]]}],onKeydownShiftEnter:[{type:e.HostListener,args:["keydown.shift.enter",["$event"]]}],onFocus:[{type:e.HostListener,args:["focus"]}],onFocusout:[{type:e.HostListener,args:["focusout"]}]};var s=function(){function t(){this.onEmojiPicked=new n.Subject}return t.prototype.setActiveComponent=function(t){this.activeComponent=t},t.prototype.isActiveComponent=function(t){return t===this.activeComponent},t}();s.decorators=[{type:e.Injectable}],s.ctorParameters=function(){return[]};var c=function(){function t(t){this.emojiService=t}return t.prototype.setEmojiService=function(t){this.emojiService=t},Object.defineProperty(t.prototype,"inputFor",{set:function(t){this.emojiService=new s,t.addEmojiService(this.emojiService)},enumerable:!0,configurable:!0}),t.prototype.emojiPicked=function(t){this.emojiService.onEmojiPicked.next(t)},t}();c.decorators=[{type:e.Component,args:[{selector:"ngx-emoji-picker",template:'<button type="button" (click)="emojiPicked(\':)\')">:)</button>\n<button type="button" (click)="emojiPicked(\';)\')">;)</button>\n<button type="button" (click)="emojiPicked(\':D\')">:D</button>\n'}]}],c.ctorParameters=function(){return[{type:s}]},c.propDecorators={inputFor:[{type:e.Input,args:["for"]}]};var p=function(){return function(){}}();p.decorators=[{type:e.NgModule,args:[{imports:[],declarations:[c,r],providers:[s],exports:[c,r]}]}],p.ctorParameters=function(){return[]},t.NgxEmojiModule=p,t.NgxEmojiPickerComponent=c,t.NgxEmojiComponent=r,t.NgxEmojiService=s,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=ngx-emoji.umd.min.js.map
